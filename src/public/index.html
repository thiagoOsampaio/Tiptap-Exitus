<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="./favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exitus Editor</title>
  <script src="./exituseditor.js"></script>
</head>

<body>
  <div class="editor-shell">
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0;

      }

      .container {
        display: flex;
        width: 100%;
        height: 100vh;
        /* Full height of the viewport */
      }

      .column {
        flex: 1;
        /* Equal width columns */
        padding: 20px;
      }
    </style>
    <div class="container">
      <div class="column">
        <button onclick="addColarQuestao('instrucao')">instrucao</button>
        <button onclick="addColarQuestao('comando')">comando</button>
        <button onclick="getColar()">Get colar</button>
        <div class="element"></div>
        <div class="element2" style="margin-top: 10px;"></div>
      </div>
      <div class="column">
        <div class="html-content editor-main">
          <div class="tiptap ProseMirror" id="testeHtml"></div>
        </div>
      </div>
    </div>

    <script>
      const defaultText = `$$x = -\\frac{b}{2a} = -\\frac{-4}{2\\cdot 2} = \\frac{4}{4} = 1$$Lorem ipsum dolor sit amet consectetur adipisicing elit. Expedita mollitia inventore maxime, eligendi esse facere laborum ut ratione temporibus beatae quibusdam dolorum placeat unde similique molestias quod deserunt magnam enim!`
      const exitusEditor = new ExitusEditor({
        container: document.querySelector('.element'),
        content: defaultText,
        config: {
          image: {
            proxyUrl: "https://us-central1-desenvolvimento-271520.cloudfunctions.net/imagem-conversao-base64/proxy",
            allowBase64: true,
          },
          initialHeight: 400,
          toolbar:{
            showOnFocus: true,
          }
        }
      })

      const exitusEditor2 = new ExitusEditor({
        container: document.querySelector('.element2'),
        editable: true,
        content: '<colar-questao title="comando">teste</colar-questao>',
      })

      exitusEditor.on('create', ({ editor }) => {
        const htmlContent = document.querySelector('#testeHtml')
        htmlContent.innerHTML = editor.getHTML()
      })

      exitusEditor.on('update', ({ editor }) => {
        const htmlContent = document.querySelector('#testeHtml')

        const latexMatches = (editor.getHTML())

        htmlContent.innerHTML = latexMatches
      })

      window.editor = exitusEditor
      window.editor2 = exitusEditor2

      function addColarQuestao(title) {
        window.editor.commands.addColarQuestao(title)
      }

      function getColar() {
        console.log(window.editor.getPluginInstance('colarQuestao').getColarQuestao());
      }
    </script>
</body>

</html>